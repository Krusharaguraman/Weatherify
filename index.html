<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Forecast</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
  .container {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 700px;
    height: 500px;
    transform: translate(-50%, -50%);
    background-color: #ffffffa6;
    padding: 0px;
    border-radius: 25px;
    border: 10px solid #41404000;
    display: flex;
    justify-content: space-between;
  }

  /* Left and Right Boxes */
  .left-box {
    background-color: #cccccc00;
    padding: 0px;
    border: 1px solid #aaaaaa00;
    width: 250px;
  }

  .right-box {
    width: 450px;
    background-color: #cccccc00;
    padding: 0px;
    border: 1px solid #aaaaaa00;
  }

  /* Box Styles */
  .left-box2, .right-box2 {
    background-color: #2e151500;
    padding: 0px;
    border: 1px solid #aaaaaa00;
    width: 120px;
    height: 90px;
    text-align: center;
    margin-top: 0;
  }

  .left-box2 p, .right-box2 p {
    font-family: Courier, monospace;
    font-size: 40px;
  }

  /* Background and Navbar */
  body {
    height: 650px;
    width: 1300px;
    background-image: url('./bg-main.png');
    background-size: cover;
    background-repeat: no-repeat;
    background-size: 1360px 750px;
    border: 0px;
  }

  .navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    height: 30px;
    width: 1323px;
  }

  .logo {
    color: rgba(255, 255, 255, 0.87);
    font-size: 70px;
  }

  .navbar h1 {
    font-size: 50px;
    color: rgb(255, 219, 205);
  }

  /* Responsive Layout */
  @media screen and (max-width: 768px) {
    .container {
      flex-direction: column;
      width: 90%;
      height: auto;
      padding: 10px;
    }

    .left-box, .right-box {
      width: 100%;
      margin-bottom: 10px;
    }

    .left-box2, .right-box2 {
      width: 100%;
      height: 80px;
    }

    .top-box, .bottom-box, .top-box2, .bottom-box2, .top-box3, .bottom-box3, .top-box4, .bottom-box4 {
      padding: 5px;
    }

    .top-box2 p, .bottom-box5 p {
      font-size: 16px;
    }

    .left-box2 p, .right-box2 p {
      font-size: 30px;
    }

    .box {
      width: 48%;
      margin: 5px;
    }

    canvas {
      width: 100%;
      height: 250px;
    }
  }

  /* Further Adjustments for Small Screens */
  @media screen and (max-width: 480px) {
    .navbar h1 {
      font-size: 30px;
    }

    .logo {
      font-size: 50px;
    }

    .left-box, .right-box {
      width: 100%;
      margin-bottom: 20px;
    }

    .left-box2, .right-box2 {
      width: 100%;
      height: 60px;
    }

    .top-box2 p, .bottom-box5 p {
      font-size: 14px;
    }

    .left-box2 p, .right-box2 p {
      font-size: 20px;
    }

    .box {
      width: 45%;
    }

    .bottom-box {
      height: auto;
    }

    canvas {
      width: 100%;
      height: 200px;
    }
  }
</style>

</head>
<body>
  <div class="navbar">
    <h1>Weatherify</h1>
    <span class="logo" >&#9729;</span>
</div>
<div class="container">
    <div class="left-box">
        <div class="top-box">
          <label for="city">Enter City: </label>
            <input type="text" id="cityInput" placeholder="Enter city name">
            <button id="fetchWeatherBtn" onclick="fetchweather()">Get Weather</button>
        </div>
        <div class="bottom-box">
            <div class="top-box2" id="date"></div>
            <div class="bottom-box2">
                <div class="top-box3">
                  <div class="left-box2" id="weatherDisplay"></div>
                    <div class="right-box2"  id="fahrenheit"></div>
                </div>
                <div class="bottom-box3" >
                  <div class="top-box5" id="weathercondn"></div>
                  <div class="bottom-box5" id="currentweather"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="right-box">
      <div class="top-box4" id="top-box4">
        <canvas id="temperatureChart" width="400" height="300"></canvas>
      </div>
        <div class="bottom-box4">
          <div class="box box1" id="day1"></div>
          <div class="box box2" id="day2"></div>
          <div class="box box3" id="day3"></div>
          <div class="box box4" id="day4"></div>
        </div>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/axios@0.21.1/dist/axios.min.js"></script>
    <script>
     let date = new Date();
let dayOfMonth = date.getDate();
let dayOfWeek = date.getDay();
let month = date.getMonth();
let days = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
let months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
let month_t = months[month];
let day = days[dayOfWeek];
let year = date.getFullYear();
document.getElementById("date").innerHTML = `<p>${day}, ${month_t} ${dayOfMonth}, ${year}</p>`;

const API_KEY = '086fc447ad9d043f22039e4299c80331';

async function getWeather(city) {
    if (!city) return alert('Please enter a city name.');

    try {
        // Get current weather and forecast
        const response = await axios.get(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${API_KEY}&units=metric`);
        const currentWeather = response.data.list[0]; // Current weather is the first entry
        const labels = [];
        const temperatures = [];
        
        // Collect forecast data
        for (let i = 0; i < response.data.list.length; i += 8) {
            labels.push(new Date(response.data.list[i].dt * 1000).toLocaleDateString());
            temperatures.push(response.data.list[i].main.temp);
        }
        
        // Update current weather display
        document.getElementById('fahrenheit').innerHTML = `<p>${Math.round((currentWeather.main.temp * 9/5) + 32)}¬∞F</p>`;
        const weatherData = getWeatherSymbol(currentWeather.weather[0].description);
        document.getElementById('weatherDisplay').innerHTML = weatherData.symbol;
        document.getElementById('weathercondn').innerHTML = `<p>${currentWeather.weather[0].description}</p>`;
        document.getElementById('currentweather').innerHTML = `<p>Wind Speed: ${currentWeather.wind.speed} m/s<br>Humidity: ${currentWeather.main.humidity}%</p>`;

        // Update future weather
        let forecastHtml = [];
        for (let i = 1; i <= 4; i++) {
            const forecast = response.data.list[i * 8]; // Every 8th entry is a day ahead
            const tday_t = days[new Date(forecast.dt * 1000).getDay()];
            const t_symbol = getWeatherSymbol(forecast.weather[0].description);
            forecastHtml.push(`
                ${tday_t}<br>
                <span>${t_symbol.symbol}<br></span>
                Temperature: ${Math.round(forecast.main.temp)}¬∞C<br>
                Humidity: ${forecast.main.humidity}%
            `);
        }
        document.getElementById('day1').innerHTML = forecastHtml[0];
        document.getElementById('day2').innerHTML = forecastHtml[1];
        document.getElementById('day3').innerHTML = forecastHtml[2];
        document.getElementById('day4').innerHTML = forecastHtml[3];
        document.getElementById('top-box4').innerHTML='<canvas id="temperatureChart" width="400" height="300"></canvas>';
        displayChart(labels, temperatures);

        // Update chart
    } catch (error) {
        console.error(error);
    }
}

function fetchweather() {
    const city = document.getElementById('cityInput').value;
    getWeather(city);
}

function getWeatherSymbol(condition) {
    switch (condition) {
    case 'broken clouds':
  return { symbol: '<p>&#x1F325;</p>' }; // üå•Ô∏è
case 'overcast clouds':
  return { symbol: '<p>&#x2601;</p>' }; // ‚òÅÔ∏è
case 'light rain':
  return { symbol: '<p>&#x1F326;</p>' }; // üå¶Ô∏è
case 'few clouds':
  return { symbol: '<p>&#x1F324;</p>' }; // üå§Ô∏è
case 'clear sky':
  return { symbol: '<p>&#x2600;</p>' }; // ‚òÄÔ∏è
case 'moderate rain':
  return { symbol: '<p>&#x1F327;</p>' }; // üåßÔ∏è
case 'heavy intensity rain':
  return { symbol: '<p>&#x1F327;</p>' }; // üåßÔ∏è
case 'scattered clouds':
  return { symbol: '<p>&#x1F325;</p>' }; // ‚õÖ
case 'haze':
  return { symbol: '<p>&#127787;</p>' }; // üå´Ô∏è
    default:
      return { symbol: '‚ùì' }; // Default case for unknown conditions
  }
}


function displayChart(labels, temperatures) {
    const ctx = document.getElementById('temperatureChart').getContext('2d');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels,
            datasets: [{
                label: 'Temperature (¬∞C)',
                data: temperatures,
                borderColor: 'rgba(75, 192, 192, 1)',
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                fill: true,
                tension: 0.1
            }]
        },
        options: { responsive: false, scales: { y: { beginAtZero: true } } }
    });
}

getWeather('trichy'); // Default city

    </script>
</body>
</html>
